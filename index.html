<!DOCTYPE html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="stylesheets/libs/bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/libs/tingle.min.css">
  </head>
  <body>
    <div class="container">
      <img height="50" src="https://betteninnovation.com/images/Logos/2015/Betteninnovation.png" alt="Stendebach logo">
      <form action="#">
        <!-- shoulders -->
        <div class="form-group row range-container">
          <label for="shoulders" class="col-sm-3 col-form-label">Schulterabstand</label>
          <div class="col-sm-4">
            <input type="range" class="form-control" name="shoulders" min="27" max="64" value="27">
          </div>
          <span class="col-sm-2 score">bis 27 cm</span>
        </div>

        <!-- neck -->
        <div class="form-group row range-container">
          <label for="neck" class="col-sm-3 col-form-label">Halsumfang</label>
          <div class="col-sm-4">
            <input type="range" class="form-control" name="neck" min="25" max="49" value="25">
          </div>
          <span class="col-sm-2 score">bis 25 cm</span>
        </div>

        <!-- head -->
        <div class="form-group row range-container">
          <label for="head" class="col-sm-3 col-form-label">Kopfumfang</label>
          <div class="col-sm-4">
            <input type="range" class="form-control" name="head" min="40" max="79" value="40">
          </div>
          <span class="col-sm-2 score">bis 40 cm</span>
        </div>

        <!-- ear-to-shoulder -->
        <div class="form-group row range-container">
          <label for="ear-to-shoulder" class="col-sm-3 col-form-label">Halslänge</label>
          <div class="col-sm-4">
            <input type="range" class="form-control" name="ear-to-shoulder" min="8" max="27" value="8">
          </div>
          <span class="col-sm-2 score">bis 8 cm</span>
        </div>

        <!-- Sleeping position -->
        <fieldset class="form-group row">
          <legend class="col-form-legend col-sm-3">Bevorzugte Schlafposition</legend>
          <div class="col-sm-4">
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="sleeping-position" value="Bauchlage" checked>
                Bauchlage
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="sleeping-position" value="Rückenlage">
                Rückenlage
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="sleeping-position" value="3/4lig">
                3/4lig
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="sleeping-position" value="Seitenlage">
                Seitenlage
              </label>
            </div>
          </div>
        </fieldset><!-- Sleeping position -->

        <!-- Mattress type -->
        <fieldset class="form-group row">
          <legend class="col-form-legend col-sm-3">Matratzenart</legend>
          <div class="col-sm-4">
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="mattress-type" value="Wasserbett" checked>
                Wasserbett
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="mattress-type" value="Weiche Matratze">
                Weiche Matratze
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="mattress-type" value="Mittlere Matratzenfestigkeit">
                Mittlere Matratzenfestigkeit
              </label>
            </div>
            <div class="form-check">
              <label class="form-check-label">
                <input class="form-check-input" type="radio" name="mattress-type" value="Harte Matratze">
                Harte Matratze
              </label>
            </div>
          </div>
        </fieldset><!-- Mattress type -->

        <div class="row justify-content-center">
          <button type="submit" class="col-sm-4 btn btn-primary">Abfrage 1 &rarr;</button>
          <div class="col-4"></div>
          <button type="submit" class="col-sm-4 btn btn-primary">Abfrage 2 &rarr;</button>
        </div>
      </form>


      <script src="javascripts/libs/tingle.min.js"></script>
      <script type="text/javascript">
        var unit = "cm";
        var until = "bis";
        var from = "von";
        var pillowForm = document.querySelector('form');

        var pillowModal = new tingle.modal({
          footer: true,
          stickyFooter: false,
          closeMethods: ['overlay', 'button', 'escape'],
          closeLabel: "Close"
        });
        pillowModal.setContent('<h1>Kissen 1 <small>(8cm)</small></h1>');
        pillowModal.addFooterBtn('Alles klar', 'btn float-right', function() {
          pillowModal.close();
        });

        var prefix = function (current, min, max) {
          if (current === min) {
            return until;
          } else if (current === max) {
            return from;
          } else {
            return ""
          }
        }

        var scoreUpdater = function (scoreElement, min, max) {
          return function() {
            scoreElement.innerHTML = prefix(this.value, min, max) + " " + this.value + " " + unit;
          };
        }

        var attachUpdateScoreHandlers = function (updater) {
          var rangeContainers = document.querySelectorAll(".range-container");

          for(var index = 0; index < rangeContainers.length; index++){
            slider = rangeContainers[index].querySelector("input[type='range']");
            score = rangeContainers[index].querySelector(".score");

            var update = updater(score, slider.min, slider.max);
            slider.onchange = update;
            slider.oninput = update;
          }
        };

        var onPillowSubmiter = function (modal) {
          return function (event) {
            event.preventDefault();
            modal.open();
          };
        }

        attachUpdateScoreHandlers(scoreUpdater);
        pillowForm.onsubmit = onPillowSubmiter(pillowModal);
      </script>
    </div>
  </body>
</html>
